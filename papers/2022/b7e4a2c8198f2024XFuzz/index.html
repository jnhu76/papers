<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XFuzz: Machine Learning Guided Cross-Contract Fuzzing</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      scroll-behavior: smooth;
    }
    .mobile-optimized {
      margin-bottom: 2rem !important;
    }
    @media (max-width: 768px) {
      .content-section {
        padding: 1rem;
        margin-bottom: 1.5rem;
      }
      .technical-details {
        margin: 1rem 0;
      }
    }
    .hide-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    .hide-scrollbar::-webkit-scrollbar {
      display: none;
    }
    .nav-item {
      @apply px-4 py-2 rounded-lg transition-colors duration-200 text-gray-600 hover:text-blue-600 hover:bg-blue-50;
    }
    .nav-item.active {
      @apply text-blue-600 bg-blue-100;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-400 via-purple-500 to-pink-400 min-h-screen">
  <!-- 导航系统 -->
  <nav class="nav-scroll bg-white/90 backdrop-blur-sm sticky top-0 z-50 border-b border-gray-200">
    <div class="container mx-auto px-4 py-3">
      <div class="flex overflow-x-auto space-x-6 hide-scrollbar">
        <a href="#abstract" class="nav-item whitespace-nowrap">摘要</a>
        <a href="#background-motivation" class="nav-item whitespace-nowrap">背景与动机</a>
        <a href="#challenges" class="nav-item whitespace-nowrap">问题与挑战</a>
        <a href="#design-implementation" class="nav-item whitespace-nowrap">设计与实现</a>
        <a href="#evaluation" class="nav-item whitespace-nowrap">测试与评估</a>
        <a href="#conclusion" class="nav-item whitespace-nowrap">结论与不足</a>
      </div>
    </div>
  </nav>

  <div class="container mx-auto px-4 py-8">
    <div class="bg-white/95 backdrop-blur-sm rounded-xl shadow-lg p-6">

      <!-- 论文标题和元数据 -->
      <div class="mb-12 md:mb-16">
        <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-6 text-center md:text-left">
          XFuzz: Machine Learning Guided Cross-Contract Fuzzing
        </h1>
        <div class="bg-gradient-to-r from-blue-50 to-purple-50 border-l-4 border-blue-500 p-6 rounded-r-lg">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-700">
            <div class="space-y-3">
              <div>
                <strong class="text-blue-700 block mb-1">作者</strong>
                <div class="text-lg">Yinxing Xue, Jiaming Ye, Wei Zhang, Jun Sun, Lei Ma, Haijun Wang, Jianjun Zhao</div>
                <div class="text-sm text-gray-600 mt-1">中国科学技术大学、九州大学、新加坡管理大学等</div>
              </div>
              <div>
                <strong class="text-blue-700 block mb-1">发表信息</strong>
                <div>投稿：2021年12月22日；录用：2022年6月2日</div>
              </div>
            </div>
            <div class="space-y-3">
              <div>
                <strong class="text-blue-700 block mb-1">研究领域</strong>
                <div class="flex flex-wrap gap-2 mt-1">
                  <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">智能合约安全</span>
                  <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">模糊测试</span>
                  <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm">机器学习</span>
                  <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm">跨合约漏洞</span>
                </div>
              </div>
              <div>
                <strong class="text-blue-700 block mb-1">支持项目</strong>
                <div class="text-sm">国家自然科学基金、江苏省基础研究计划、新加坡国家研究基金等</div>
              </div>
            </div>
          </div>
        </div>

      <!-- AI生成内容标识 -->
      <div class="mt-6 mb-8 p-4 bg-gradient-to-r from-amber-50 to-orange-50 border-l-4 border-amber-500 rounded-r-lg shadow-sm">
        <div class="flex items-start gap-3">
          <div class="flex-shrink-0 mt-0.5">
            <svg class="w-6 h-6 text-amber-600" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
            </svg>
          </div>
          <div class="flex-1">
            <div class="flex flex-wrap items-center gap-2 mb-2">
              <span class="px-3 py-1 bg-amber-100 text-amber-800 text-sm font-bold rounded-full border border-amber-200">
                ⚠️ AI生成内容
              </span>
              <span class="text-xs text-amber-700 font-medium px-2 py-1 bg-amber-50 rounded">
                法律要求标识
              </span>
            </div>
            <p class="text-sm text-gray-700 leading-relaxed">
              根据《人工智能生成合成内容标识办法》要求，本文的<strong class="text-amber-700">解析、评述及总结内容由人工智能模型生成</strong>。生成内容可能存在不准确、过时或偏差，仅作为学习参考之用。
            </p>
            <div class="mt-3 pt-3 border-t border-amber-200">
              <p class="text-xs text-gray-600 flex items-start">
                <svg class="w-4 h-4 mr-2 mt-0.5 text-blue-500 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                </svg>
                建议您：1) 核对原始论文；2) 结合专业知识判断；3) 不依赖AI生成内容做出关键学术决策。
              </p>
            </div>
          </div>
        </div>
      </div>

        <!-- 核心贡献突出显示 -->
        <div class="bg-gradient-to-r from-green-50 to-blue-50 border-l-4 border-green-500 p-6 rounded-r-lg mt-6">
          <h4 class="font-bold text-green-700 mb-4 flex items-center text-xl">
            <i class="fas fa-trophy mr-2"></i>核心贡献
          </h4>
          <ul class="list-disc list-inside space-y-2 text-gray-700">
            <li><strong>首次系统化定义并检测跨合约漏洞</strong>：针对重入、delegatecall、tx-origin三类跨合约漏洞提出形式化定义。</li>
            <li><strong>机器学习引导的模糊测试框架</strong>：通过ML模型筛选可能易受攻击的函数，将搜索空间减少80.1%。</li>
            <li><strong>路径优先级算法</strong>：结合静态特征和模型预测对可疑路径进行排序，提高漏洞发现效率。</li>
            <li><strong>实验验证有效性</strong>：在7391个合约上发现18个可被利用的跨合约漏洞，其中15个是首次发现。</li>
          </ul>
        </div>
      </div>

      <!-- 各技术章节 -->
      <section id="abstract" class="content-section mobile-optimized mb-12 md:mb-16">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 md:mb-8 flex items-center">
          <i class="fas fa-file-alt mr-3 text-blue-500"></i>
          摘要
        </h2>
        <div class="space-y-4 text-gray-700 leading-relaxed">
          <p><strong>本文解决的问题：</strong>随着智能合约交易中跨合约调用的增加，现有的漏洞检测工具大多只能分析单个或最多两个合约，<strong>忽视了跨合约漏洞</strong>。这类漏洞只在三个或以上合约的交互中显现，搜索空间巨大。</p>
          <p><strong>作者的解决方案：</strong>提出<strong>XFuzz</strong>，一个<strong>机器学习引导的智能合约模糊测试框架</strong>。使用ML模型（基于词向量和静态特征训练）过滤掉80.1%的非漏洞函数，缩小搜索范围。然后通过路径优先级算法指导模糊测试器重点关注高风险路径。</p>
          <p><strong>主要结果：</strong>在7391个合约上与三种最先进的工具对比，XFuzz检测出<strong>18个可被利用的跨合约漏洞</strong>（其中15个首次发现）。在检测非跨合约漏洞时，<strong>用少于20%的时间发现了比sFuzz多一倍的漏洞</strong>。</p>
        </div>
      </section>

      <section id="background-motivation" class="content-section mobile-optimized mb-12 md:mb-16">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 md:mb-8 flex items-center">
          <i class="fas fa-layer-group mr-3 text-blue-500"></i>
          背景与动机
        </h2>
        <div class="space-y-6">
          <div class="bg-gray-50 p-4 rounded-lg">
            <h3 class="font-bold text-gray-700 mb-3 flex items-center">
              <i class="fas fa-exclamation-circle text-red-500 mr-2"></i>
              智能合约安全现状
            </h3>
            <ul class="list-disc list-inside space-y-2 text-gray-700">
              <li><strong>高价值目标：</strong>智能合约承载大量金融交易，漏洞导致巨额损失（如DAO攻击损失1.5亿美元）。</li>
              <li><strong>安全性要求高：</strong>超75%的开发者认为智能合约比传统软件的安全要求更高。</li>
              <li><strong>现有工具局限：</strong>分为静态分析（高误报）和动态分析/模糊测试（覆盖率低）。两者都依赖预定义规则，且<strong>大多只关注单合约或双合约</strong>。</li>
            </ul>
          </div>

          <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
            <h3 class="font-bold text-blue-700 mb-3 flex items-center">
              <i class="fas fa-bullseye mr-2"></i>
              为何需要检测跨合约漏洞？
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
              <div class="p-3 bg-white rounded">
                <strong class="block mb-1">🧩 交互复杂性</strong>
                一个漏洞可能需要三个合约按特定顺序交互才能触发，如图4所示。
              </div>
              <div class="p-3 bg-white rounded">
                <strong class="block mb-1">🔍 搜索空间爆炸</strong>
                多个合约的函数调用序列和交错组合，使得穷举测试不可行。
              </div>
              <div class="p-3 bg-white rounded">
                <strong class="block mb-1">🚫 现有工具失效</strong>
                主流模糊测试工具如ContractFuzzer和sFuzz因最多分析两个合约而漏报。
              </div>
              <div class="p-3 bg-white rounded">
                <strong class="block mb-1">📈 现实需求迫切</strong>
                实践中存在大量跨合约交易，急需系统性检测方法。
              </div>
            </div>
          </div>

          <!-- 图4可视化占位符 -->
          <details class="technical-details bg-gray-50 rounded-lg p-4 md:p-6 mb-8 mt-6">
            <summary class="cursor-pointer font-semibold text-lg md:text-xl text-gray-800 hover:text-blue-600 transition-colors py-2">
              <i class="fas fa-project-diagram mr-2"></i>动机案例：图4 - 一个被sFuzz漏报的跨合约重入漏洞
            </summary>
            <div class="mt-6 space-y-6">
              <div class="original-figure-container">
                <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-4 gap-2">
                  <h5 class="font-semibold text-gray-700 text-base md:text-lg">
                    <i class="fas fa-image mr-2 text-blue-500"></i>
                    原图 4: 跨合约重入漏洞示例
                  </h5>
                  <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded self-start sm:self-auto">论文原图</span>
                </div>
                <div class="image-placeholder bg-gradient-to-br from-gray-100 to-gray-200 p-6 md:p-8 rounded-lg text-center border-2 border-dashed border-gray-300">
                  <img src="./images/fig4.png" alt="论文图4：展示了一个涉及三个合约（Logging, Logic, Wallet）的跨合约重入攻击路径。红色箭头突出跨合约调用，蓝色箭头表示被sFuzz遗漏的调用。" class="max-w-full h-auto rounded-lg">
                </div>
                <div class="mt-4 text-sm text-gray-600 bg-gray-50 p-3 rounded border">
                  <strong>原图图注:</strong> 一个被当前最先进的模糊测试器sFuzz漏报的跨合约重入漏洞示例。实线框代表函数，虚线框代表合约。实线表示函数调用。红色箭头突出跨合约调用。蓝色箭头表示被sFuzz和ContractFuzzer遗漏的跨合约调用。
                </div>
              </div>
              <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                <h5 class="font-semibold text-red-700 mb-3 flex items-center">
                  <i class="fas fa-exclamation-triangle mr-2"></i>
                  漏洞技术解释：
                </h5>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                  <li><strong>攻击链：</strong>攻击者合约(Logging) → 逻辑合约(Logic) → 钱包合约(Wallet)。钱包合约在转账后回调攻击者合约，形成循环盗币。</li>
                  <li><strong>关键：</strong>漏洞需要<strong>三个合约的特定交互序列</strong>才能触发。</li>
                  <li><strong>现有工具为何漏报：</strong>sFuzz和ContractFuzzer在测试时最多同时考虑两个合约，因此无法构造出这条三合约攻击路径。</li>
                </ul>
              </div>
            </div>
          </details>
        </div>
      </section>

      <section id="challenges" class="content-section mobile-optimized mb-12 md:mb-16">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 md:mb-8 flex items-center">
          <i class="fas fa-exclamation-triangle mr-3 text-blue-500"></i>
          问题与挑战
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="bg-gradient-to-br from-red-50 to-orange-50 p-5 rounded-xl border border-red-200">
            <h4 class="font-bold text-red-700 mb-3 flex items-center">
              <i class="fas fa-search mr-2"></i>
              挑战一：巨大的搜索空间
            </h4>
            <p class="text-gray-700">对于包含多个合约的系统，需要考虑所有可能的<strong>函数调用序列和交错</strong>。穷举测试在时间上不可行。</p>
          </div>
          <div class="bg-gradient-to-br from-yellow-50 to-amber-50 p-5 rounded-xl border border-yellow-200">
            <h4 class="font-bold text-yellow-700 mb-3 flex items-center">
              <i class="fas fa-brain mr-2"></i>
              挑战二：如何有效引导
            </h4>
            <p class="text-gray-700">需要一种方法来<strong>智能地识别出可能易受攻击的函数和路径</strong>，而不是盲目测试。</p>
          </div>
          <div class="bg-gradient-to-br from-blue-50 to-cyan-50 p-5 rounded-xl border border-blue-200">
            <h4 class="font-bold text-blue-700 mb-3 flex items-center">
              <i class="fas fa-tools mr-2"></i>
              挑战三：静态分析工具的偏差
            </h4>
            <p class="text-gray-700">不同静态分析工具（如Slither、Securify）的检测规则可能存在<strong>矛盾或偏差</strong>，直接依赖单一工具不可靠。</p>
          </div>
          <div class="bg-gradient-to-br from-purple-50 to-pink-50 p-5 rounded-xl border border-purple-200">
            <h4 class="font-bold text-purple-700 mb-3 flex items-center">
              <i class="fas fa-code mr-2"></i>
              挑战四：跨合约调用支持
            </h4>
            <p class="text-gray-700">模糊测试器需要能够在测试环境中<strong>部署多个合约并模拟它们之间的真实调用</strong>，而不仅仅是单个合约的测试。</p>
          </div>
        </div>
      </section>

      <section id="design-implementation" class="content-section mobile-optimized mb-12 md:mb-16">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 md:mb-8 flex items-center">
          <i class="fas fa-cogs mr-3 text-blue-500"></i>
          设计与实现
        </h2>

        <!-- XFuzz整体框架图 -->
        <details class="technical-details bg-gray-50 rounded-lg p-4 md:p-6 mb-8">
          <summary class="cursor-pointer font-semibold text-lg md:text-xl text-gray-800 hover:text-blue-600 transition-colors py-2">
            <i class="fas fa-sitemap mr-2"></i>系统概览：图5 - XFuzz 框架
          </summary>
          <div class="mt-6 space-y-6">
            <div class="original-figure-container">
              <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-4 gap-2">
                <h5 class="font-semibold text-gray-700 text-base md:text-lg">
                  <i class="fas fa-image mr-2 text-blue-500"></i>
                  原图 5: XFuzz 框架概述
                </h5>
                <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded self-start sm:self-auto">论文原图</span>
              </div>
              <div class="image-placeholder bg-gradient-to-br from-gray-100 to-gray-200 p-6 md:p-8 rounded-lg text-center border-2 border-dashed border-gray-300">
                <img src="./images/fig5.png" alt="论文图5：展示了XFuzz的两阶段框架：机器学习模型训练阶段和引导模糊测试阶段。左侧是从数据收集、特征工程到模型训练的流程；右侧是使用训练好的模型预测、路径优先级排序和最终模糊测试的流程。" class="max-w-full h-auto rounded-lg">
              </div>
              <div class="mt-4 text-sm text-gray-600 bg-gray-50 p-3 rounded border">
                <strong>原图图注:</strong> XFuzz的框架概述。框架可分为两个阶段：机器学习模型训练阶段和引导模糊测试阶段。
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                <h5 class="font-semibold text-blue-700 mb-3">阶段一：ML模型训练</h5>
                <ol class="list-decimal list-inside space-y-2 text-sm text-gray-700">
                  <li><strong>数据收集与标注：</strong>从Etherscan收集10万份合约，使用三个静态工具(Slither, Securify, Solhint)投票标注漏洞。</li>
                  <li><strong>特征工程：</strong>将合约字节码通过Word2Vec转为20维向量，并加入7个手动设计的静态特征（如是否有call、是否能发送ETH）。</li>
                  <li><strong>模型训练与选择：</strong>在多个模型（XGBoost、EasyEnsemble等）中，选择在高度不平衡数据上<strong>召回率最高(95%)</strong>的EasyEnsembleClassifier模型。</li>
                </ol>
              </div>
              <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                <h5 class="font-semibold text-green-700 mb-3">阶段二：引导模糊测试</h5>
                <ol class="list-decimal list-inside space-y-2 text-sm text-gray-700">
                  <li><strong>预测与筛选：</strong>使用训练好的模型预测新合约的函数，过滤掉大量非漏洞函数。</li>
                  <li><strong>路径构造与优先级排序：</strong>基于调用图和控制流图构造跨合约调用路径，并使用<strong>优先级算法</strong>（基于函数和调用者复杂度）对路径排序。</li>
                  <li><strong>跨合约模糊测试：</strong>在私有链上部署所有相关合约，按照优先级顺序测试路径，触发并报告漏洞。</li>
                </ol>
              </div>
            </div>
          </div>
        </details>

        <div class="space-y-8">
          <div>
            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
              <i class="fas fa-microchip mr-2 text-purple-500"></i>
              关键技术1：基于机器学习的漏洞函数筛选
            </h3>
            <div class="bg-gray-50 p-4 rounded-lg">
              <p class="mb-4">目标：快速识别出<strong>易出错的代码</strong>（遵循帕累托原则）。作者没有直接采用某个静态工具的规则，而是用三个工具投票，并用ML模型从投票结果中学习模式，以减少单一工具的偏差。</p>
              <div class="overflow-x-auto">
                <table class="min-w-full bg-white border border-gray-300 rounded-lg">
                  <thead class="bg-gray-100">
                    <tr>
                      <th class="py-2 px-4 border-b text-left font-bold">特征类别</th>
                      <th class="py-2 px-4 border-b text-left font-bold">特征示例</th>
                      <th class="py-2 px-4 border-b text-left font-bold">作用</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr><td class="py-2 px-4 border-b">词向量</td><td>20维Word2Vec向量</td><td>捕获字节码的语义信息</td></tr>
                    <tr><td class="py-2 px-4 border-b">静态特征</td><td>has_call, can_send_eth</td><td>识别外部调用、转账能力等风险操作</td></tr>
                    <tr><td class="py-2 px-4 border-b">关键操作码特征</td><td>has_delegate, has_tx_origin</td><td>专门针对delegatecall和tx-origin漏洞</td></tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <div>
            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
              <i class="fas fa-sort-amount-down mr-2 text-green-500"></i>
              关键技术2：路径优先级算法
            </h3>
            <p class="mb-4">即使经过ML筛选，可疑路径数量仍可能很多。作者提出一个算法，为每条路径计算一个<strong>优先级分数</strong>，分数越低优先级越高，让模糊测试器先测试最有可能发现漏洞的路径。</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                <h5 class="font-bold text-green-700 mb-3">函数优先级分数</h5>
                <p class="text-sm text-gray-700 mb-2">评估函数自身的复杂度和被调用的难度。</p>
                <ul class="list-disc list-inside text-sm space-y-1">
                  <li><strong>可疑因子</strong>：ML模型预测为可疑的函数得分更低。</li>
                  <li><strong>调用者维度</strong>：调用者越多，测试越耗时。</li>
                  <li><strong>参数维度</strong>：复杂参数（数组、字节）增加穿透难度。</li>
                </ul>
              </div>
              <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                <h5 class="font-bold text-blue-700 mb-3">调用者优先级分数</h5>
                <p class="text-sm text-gray-700 mb-2">评估从调用者到达目标函数的路径难度。</p>
                <ul class="list-disc list-inside text-sm space-y-1">
                  <li><strong>条件复杂度</strong>：路径上if、require等条件语句的数量。</li>
                  <li><strong>条件距离</strong>：从函数入口到第一个条件语句的语句数。</li>
                </ul>
              </div>
            </div>
          </div>

          <div>
            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
              <i class="fas fa-exchange-alt mr-2 text-red-500"></i>
              关键技术3：跨合约模糊测试执行
            </h3>
            <p>为了触发跨合约漏洞，XFuzz需要在测试环境中模拟真实的多合约交互：</p>
            <ol class="list-decimal list-inside space-y-2 mt-2 text-gray-700 pl-4">
              <li><strong>部署所有合约</strong>到本地私有链，允许它们互相调用。</li>
              <li><strong>初始化状态</strong>：先调用与目标路径无关的函数来设置合约状态。</li>
              <li><strong>解析函数选择器</strong>，以便能正确触发跨合约调用。</li>
              <li>模糊测试器<strong>自动搜索并触发</strong>跨合约调用路径。</li>
            </ol>
          </div>
        </div>
      </section>

      <section id="evaluation" class="content-section mobile-optimized mb-12 md:mb-16">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 md:mb-8 flex items-center">
          <i class="fas fa-chart-line mr-3 text-blue-500"></i>
          测试与评估
        </h2>
        <p class="mb-6">作者在两个数据集上与三个先进工具进行了对比：静态跨合约检测器Clairvoyance，动态模糊测试器sFuzz和ContractFuzzer。</p>

        <!-- 评估结果可视化 -->
        <div class="space-y-8">
          <div>
            <h3 class="text-xl font-bold text-gray-800 mb-4">🎯 有效性评估 (RQ1)</h3>
            <div class="overflow-x-auto mb-6">
              <table class="min-w-full bg-white border border-gray-300 rounded-lg text-sm">
                <thead class="bg-gray-100">
                  <tr>
                    <th class="py-3 px-4 border-b text-left font-bold">漏洞类型 / 工具</th>
                    <th class="py-3 px-4 border-b text-left font-bold">Precision</th>
                    <th class="py-3 px-4 border-b text-left font-bold">Recall</th>
                    <th class="py-3 px-4 border-b text-left font-bold"># Vul. Found</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="bg-blue-50"><td class="py-2 px-4 border-b font-bold" colspan="4">跨合约漏洞</td></tr>
                  <tr><td class="py-2 px-4 border-b">XFuzz (重入)</td><td class="py-2 px-4 border-b"><strong>100%</strong></td><td class="py-2 px-4 border-b">81.2%</td><td class="py-2 px-4 border-b"><strong>13</strong></td></tr>
                  <tr><td class="py-2 px-4 border-b">Clairvoyance (重入)</td><td class="py-2 px-4 border-b">43.7%</td><td class="py-2 px-4 border-b">43.7%</td><td class="py-2 px-4 border-b">7</td></tr>
                  <tr><td class="py-2 px-4 border-b">sFuzz / ContractFuzzer</td><td class="py-2 px-4 border-b">0%</td><td class="py-2 px-4 border-b">0%</td><td class="py-2 px-4 border-b">0</td></tr>
                  <tr class="bg-green-50"><td class="py-2 px-4 border-b font-bold" colspan="4">非跨合约漏洞 (重入)</td></tr>
                  <tr><td class="py-2 px-4 border-b">XFuzz</td><td class="py-2 px-4 border-b">95.5%</td><td class="py-2 px-4 border-b"><strong>84.6%</strong></td><td class="py-2 px-4 border-b"><strong>156</strong></td></tr>
                  <tr><td class="py-2 px-4 border-b">sFuzz</td><td class="py-2 px-4 border-b">84.2%</td><td class="py-2 px-4 border-b">33.5%</td><td class="py-2 px-4 border-b">70</td></tr>
                  <tr><td class="py-2 px-4 border-b">ContractFuzzer</td><td class="py-2 px-4 border-b">100%</td><td class="py-2 px-4 border-b">1.7%</td><td class="py-2 px-4 border-b">3</td></tr>
                </tbody>
              </table>
            </div>
            <div class="bg-green-50 p-4 rounded-lg">
              <p><strong>关键发现：</strong></p>
              <ul class="list-disc list-inside mt-2 space-y-1 text-gray-700">
                <li>XFuzz在<strong>跨合约漏洞检测上实现了零的突破</strong>，而sFuzz和ContractFuzzer完全无法检测。</li>
                <li>即使在非跨合约漏洞检测上，XFuzz的<strong>召回率(84.6%)也远高于sFuzz(33.5%)</strong>，且发现的漏洞总数是sFuzz的两倍多。</li>
                <li>发现的18个跨合约漏洞中，<strong>15个是首次被公开披露</strong>。</li>
              </ul>
            </div>
          </div>

          <div>
            <h3 class="text-xl font-bold text-gray-800 mb-4">⚡ 引导机制的有效性 (RQ2)</h3>
            <p class="mb-4">为了验证ML模型和路径优先级的作用，作者比较了XFuzz（使用引导）和sFuzz（无引导）的漏洞发现过程。</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                <h5 class="font-bold text-purple-700 mb-3">ML模型节省时间</h5>
                <p class="text-sm">如果将模型预测为良性的合约的测试时间限制<strong>从180秒减少到30秒</strong>，XFuzz仍然能找到<strong>几乎所有的漏洞</strong>。如果将时间降到0秒（完全跳过），仍能找到82.8%的重入漏洞。证明ML模型有效识别了低风险合约。</p>
              </div>
              <div class="bg-amber-50 p-4 rounded-lg border border-amber-200">
                <h5 class="font-bold text-amber-700 mb-3">路径优先级聚焦目标</h5>
                <p class="text-sm">在XFuzz测试的前10条路径中，发现了<strong>152个重入漏洞</strong>（占总数的绝大部分）。而在sFuzz的前10条路径中只发现了57个。证明优先级算法成功将测试资源导向了最脆弱的路径。</p>
              </div>
            </div>
          </div>

          <div>
            <h3 class="text-xl font-bold text-gray-800 mb-4">⏱️ 效率评估 (RQ3)</h3>
            <p>XFuzz的总时间消耗约为4,300分钟，而sFuzz需要约22,000分钟。<strong>XFuzz节省了超过80%的搜索时间</strong>，这主要归功于ML模型过滤掉了大量无需深度测试的合约。虽然实际测试每个路径的时间稍长（因为要处理跨合约调用），但总体效率大幅提升。</p>
          </div>

          <div>
            <h3 class="text-xl font-bold text-gray-800 mb-4">🔍 现实案例分析 (RQ4) 与 局限性</h3>
            <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-300">
              <h5 class="font-bold text-yellow-700 mb-3">XFuzz成功发现的案例</h5>
              <ul class="list-disc list-inside space-y-2 text-gray-700">
                <li><strong>内部调用路径：</strong>XFuzz的优先级算法能够识别出通过<code>internal</code>修饰符限制，但仍可通过其他内部函数触发的重入路径。</li>
                <li><strong>跨合约绕过权限：</strong>在一个真实的审计合约中，XFuzz发现攻击者可以通过一个公开的跨合约调用，绕过<code>onlyRegister</code>修饰符的权限检查，直接调用受限函数盗取代币。</li>
              </ul>
            </div>
            <div class="bg-red-50 p-4 rounded-lg border border-red-300 mt-6">
              <h5 class="font-bold text-red-700 mb-3">局限性（漏报原因）</h5>
              <p class="text-gray-700 mb-2">XFuzz漏报了3个跨合约漏洞和27个非跨合约漏洞，主要原因是：</p>
              <ul class="list-disc list-inside space-y-1 text-gray-700">
                <li><strong>复杂的路径条件：</strong>路径上包含涉及多个变量、数组和复杂逻辑的<code>if</code>或<code>require</code>语句，模糊测试器难以生成满足条件的输入来穿透。</li>
                <li><strong>路径爆炸的残余：</strong>即使经过筛选和排序，对于特别大型的合约系统，路径空间依然可能很大。</li>
                <li><strong>论文指出</strong>，未来可以考虑将XFuzz与符号执行（如Z3求解器）结合，形成混合模糊测试，以解决复杂条件的问题。</li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <section id="conclusion" class="content-section mobile-optimized mb-12 md:mb-16">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 md:mb-8 flex items-center">
          <i class="fas fa-flag-checkered mr-3 text-blue-500"></i>
          结论与不足
        </h2>
        <div class="space-y-8">
          <div class="bg-gradient-to-r from-blue-50 to-cyan-50 p-6 rounded-xl border-l-4 border-blue-500">
            <h3 class="text-xl font-bold text-gray-800 mb-4">🏆 本文的贡献总结</h3>
            <ol class="list-decimal list-inside space-y-3 text-gray-700 pl-4">
              <li><strong>首次系统性关注跨合约漏洞：</strong>对重入、delegatecall、tx-origin三类跨合约漏洞给出了形式化定义，并开发了专门的检测工具。</li>
              <li><strong>创新的ML引导模糊测试框架：</strong>利用机器学习模型从大量合约中快速筛选出高风险函数，将搜索空间减少80%以上。</li>
              <li><strong>高效的路径优先级算法：</strong>结合静态特征和模型预测，指导模糊测试器优先探索最有可能存在漏洞的路径，极大提升测试效率。</li>
              <li><strong>充分的实验验证：</strong>在大量真实合约上验证了有效性，发现了18个真实可被利用的跨合约漏洞，并在非跨合约漏洞检测上也显著优于现有工具。</li>
            </ol>
          </div>

          <div class="bg-gradient-to-r from-amber-50 to-orange-50 p-6 rounded-xl border-l-4 border-amber-500">
            <h3 class="text-xl font-bold text-gray-800 mb-4">⚠️ 论文的不足之处 (AI评述)</h3>
            <p class="mb-4 text-gray-700">以下分析由AI基于论文内容生成，旨在为读者提供批判性视角：</p>
            <ul class="list-disc list-inside space-y-3 text-gray-700 pl-4">
              <li><strong>漏洞类型覆盖有限：</strong>论文只聚焦于三种跨合约漏洞（重入、delegatecall、tx-origin）。智能合约的其他跨合约风险，如时间戳依赖、访问控制逻辑在多合约间的传递缺陷等，未被纳入研究。</li>
              <li><strong>ML模型的通用性挑战：</strong>模型在Solidity 0.4.24/0.4.25版本上训练和评估。随着Solidity语言的快速迭代和新特性的加入（如0.8.x版本的安全数学运算），模型的泛化能力可能需要重新验证。</li>
              <li><strong>对复杂逻辑的处理不足：</strong>正如论文自己指出的，复杂的路径条件是导致漏报的主要原因。当前的模糊测试策略对于需要特定状态组合或复杂条件推理的深度漏洞，发现能力有限。</li>
              <li><strong>实验对比的局限性：</strong>虽然与几个主要工具进行了对比，但一些较新的或专有的模糊测试/符号执行工具（如Echidna, Harvey）未包含在对比中，可能影响对“最先进”地位的全面评估。</li>
              <li><strong>性能评估维度单一：</strong>主要评估了漏洞发现的数量和精度/召回率，但对于大型合约项目（如DeFi协议）的<strong>可扩展性分析</strong>（例如内存消耗、多合约部署的协调开销）着墨不多。</li>
            </ul>
          </div>

          <div class="bg-gradient-to-r from-green-50 to-teal-50 p-6 rounded-xl border-l-4 border-green-500">
            <h3 class="text-xl font-bold text-gray-800 mb-4">🚀 未来工作方向</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="p-3 bg-white rounded border">
                <strong class="text-green-700 block mb-1">🧩 支持更多漏洞类型</strong>
                将框架扩展到检测其他类型的跨合约和单合约漏洞。
              </div>
              <div class="p-3 bg-white rounded border">
                <strong class="text-green-700 block mb-1">🤖 混合分析方法</strong>
                集成符号执行或约束求解器，以解决复杂路径条件问题。
              </div>
              <div class="p-3 bg-white rounded border">
                <strong class="text-green-700 block mb-1">📈 大规模与实时分析</strong>
                研究如何将技术应用于整个区块链的实时监控或大型DeFi组合的审计。
              </div>
              <div class="p-3 bg-white rounded border">
                <strong class="text-green-700 block mb-1">🔄 持续学习与适应</strong>
                开发能够随着新合约和新漏洞模式出现而持续更新的ML模型。
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- 交互脚本 -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const navItems = document.querySelectorAll('.nav-item');
      const sections = document.querySelectorAll('section');

      function highlightNav() {
        let current = '';
        sections.forEach(section => {
          const sectionTop = section.offsetTop;
          const sectionHeight = section.clientHeight;
          if (window.scrollY >= (sectionTop - 100)) {
            current = section.getAttribute('id');
          }
        });

        navItems.forEach(item => {
          item.classList.remove('active');
          if (item.getAttribute('href') === `#${current}`) {
            item.classList.add('active');
          }
        });
      }

      window.addEventListener('scroll', highlightNav);

      navItems.forEach(item => {
        item.addEventListener('click', function(e) {
          e.preventDefault();
          const targetId = this.getAttribute('href');
          const targetSection = document.querySelector(targetId);
          window.scrollTo({
            top: targetSection.offsetTop - 80,
            behavior: 'smooth'
          });
        });
      });
    });
  </script>
  <!-- AI生成内容标识 -->
  <div id="ai-badge" style="position: fixed; bottom: 20px; right: 20px; z-index: 9999; cursor: pointer;">
    <div style="background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; padding: 8px 16px; border-radius: 20px; font-size: 14px; font-weight: 600; box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3); display: flex; align-items: center; gap: 6px; transition: all 0.3s ease;">
      <span style="font-size: 16px;">🤖</span>
      <span>AI生成</span>
    </div>
  </div>
  <script>
    (function() {
      const badge = document.getElementById('ai-badge');
      let expanded = false;
      badge.addEventListener('click', function() {
        if (!expanded) {
          const details = document.createElement('div');
          details.id = 'ai-details';
          details.style.cssText = "position:absolute;bottom:50px;right:0;background:white;color:#333;padding:12px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.15);width:200px;font-size:12px;line-height:1.5;border:1px solid #e5e7eb;";
          details.innerHTML = '<div style="font-weight:600;margin-bottom:8px;color:#6366f1">人工智能生成内容</div><div style="color:#666">本页面内容通过AI技术自动生成，仅供参考。生成时间：' + new Date().toLocaleDateString('zh-CN') + '</div>';
          badge.appendChild(details);
          expanded = true;
        } else {
          const details = document.getElementById('ai-details');
          if (details) details.remove();
          expanded = false;
        }
      });
    })();
  </script>
</body>
</html>