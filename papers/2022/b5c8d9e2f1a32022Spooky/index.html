<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Spooky: Granulating LSM-Tree Compactions Correctly</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { 
      font-family: 'Inter', sans-serif; 
      scroll-behavior: smooth;
    }
    .mobile-optimized { 
      margin-bottom: 2rem !important; 
    }
    @media (max-width: 768px) {
      .content-section { 
        padding: 1rem; 
        margin-bottom: 1.5rem;
      }
      .technical-details {
        margin: 1rem 0;
      }
    }
    .hide-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    .hide-scrollbar::-webkit-scrollbar {
      display: none;
    }
    .nav-item {
      @apply px-4 py-2 rounded-lg transition-colors duration-200 text-gray-600 hover:text-blue-600 hover:bg-blue-50;
    }
    .nav-item.active {
      @apply text-blue-600 bg-blue-100;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-400 via-purple-500 to-pink-400 min-h-screen">
  <!-- 导航系统 -->
  <nav class="nav-scroll bg-white/90 backdrop-blur-sm sticky top-0 z-50 border-b border-gray-200">
    <div class="container mx-auto px-4 py-3">
      <div class="flex overflow-x-auto space-x-6 hide-scrollbar">
        <a href="#abstract" class="nav-item whitespace-nowrap">摘要</a>
        <a href="#background-motivation" class="nav-item whitespace-nowrap">背景与动机</a>
        <a href="#challenges" class="nav-item whitespace-nowrap">问题与挑战</a>
        <a href="#design-implementation" class="nav-item whitespace-nowrap">设计与实现</a>
        <a href="#evaluation" class="nav-item whitespace-nowrap">测试与评估</a>
        <a href="#conclusion" class="nav-item whitespace-nowrap">结论</a>
      </div>
    </div>
  </nav>

  <div class="container mx-auto px-4 py-8">
    <div class="bg-white/95 backdrop-blur-sm rounded-xl shadow-lg p-6">
      <!-- 论文标题和元数据 -->
      <div class="mb-12 md:mb-16">
        <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-6 text-center md:text-left">
          Spooky: Granulating LSM-Tree Compactions Correctly
        </h1>
        
        <div class="bg-gradient-to-r from-blue-50 to-purple-50 border-l-4 border-blue-500 p-6 rounded-r-lg">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-700">
            <div class="space-y-3">
              <div>
                <strong class="text-blue-700 block mb-1">作者信息</strong>
                <div class="text-lg">Niv Dayan, Tamar Weiss, Shmuel Dashevsky, Michael Pan, Edward Bortnikov, Moshe Twitto</div>
                <div class="text-sm text-gray-600 mt-1">University of Toronto, Pliops</div>
              </div>
              <div>
                <strong class="text-blue-700 block mb-1">发表信息</strong>
                <div>VLDB 2022 (Proceedings of the VLDB Endowment, Vol. 15, No. 11)</div>
              </div>
            </div>
            <div class="space-y-3">
              <div>
                <strong class="text-blue-700 block mb-1">DOI标识</strong>
                <div class="font-mono text-sm bg-white px-3 py-2 rounded border">10.14778/3551793.3551853</div>
              </div>
              <div>
                <strong class="text-blue-700 block mb-1">关键词</strong>
                <div class="flex flex-wrap gap-2 mt-1">
                  <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">LSM-Tree</span>
                  <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">Compaction</span>
                  <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm">Storage Efficiency</span>
                  <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm">Write Amplification</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- AI生成内容标识 -->
      <div class="mt-6 mb-8 p-4 bg-gradient-to-r from-amber-50 to-orange-50 border-l-4 border-amber-500 rounded-r-lg shadow-sm">
        <div class="flex items-start gap-3">
          <div class="flex-shrink-0 mt-0.5">
            <svg class="w-6 h-6 text-amber-600" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
            </svg>
          </div>
          
          <div class="flex-1">
            <div class="flex flex-wrap items-center gap-2 mb-2">
              <span class="px-3 py-1 bg-amber-100 text-amber-800 text-sm font-bold rounded-full border border-amber-200">
                ⚠️ AI生成内容
              </span>
              <span class="text-xs text-amber-700 font-medium px-2 py-1 bg-amber-50 rounded">
                法律要求标识
              </span>
            </div>
            
            <p class="text-sm text-gray-700 leading-relaxed">
              根据《人工智能生成合成内容标识办法》要求，本文的<strong class="text-amber-700">解析、评述及总结内容由人工智能模型生成</strong>。生成内容可能存在不准确、过时或偏差，仅作为学习参考之用。
            </p>
            
            <div class="mt-3 pt-3 border-t border-amber-200">
              <p class="text-xs text-gray-600 flex items-start">
                <svg class="w-4 h-4 mr-2 mt-0.5 text-blue-500 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                </svg>
                建议您：1) 核对原始论文；2) 结合专业知识判断；3) 不依赖AI生成内容做出关键学术决策。
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- 核心贡献突出显示 -->
      <div class="bg-gradient-to-r from-green-50 to-blue-50 border-l-4 border-green-500 p-6 rounded-r-lg mb-12">
        <h4 class="font-bold text-green-700 text-xl mb-4 flex items-center">
          <i class="fas fa-trophy mr-3"></i>论文核心贡献
        </h4>
        <ul class="list-disc list-inside space-y-3 text-gray-700">
          <li><strong>系统分析现有合并策略的局限性</strong>：作者通过成本模型和实验证明Full Merge存在空间放大问题，Partial Merge存在写放大问题</li>
          <li><strong>提出Spooky新型合并粒度方法</strong>：设计了一种分区合并策略，在较大层级上按完美重叠的文件组进行合并</li>
          <li><strong>实现SSD友好的I/O模式</strong>：通过顺序写入和删除模式减少SSD垃圾回收开销</li>
          <li><strong>实验验证全面改进</strong>：相比Full Merge降低2倍以上空间放大，相比Partial Merge降低2倍以上写放大</li>
          <li><strong>广泛的适用性</strong>：Spooky可应用于多种合并策略（leveling、tiering、lazy leveling）</li>
        </ul>
      </div>

      <!-- 摘要 -->
      <section id="abstract" class="content-section mobile-optimized mb-12 md:mb-16">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 md:mb-8 flex items-center">
          <i class="fas fa-file-alt mr-3 text-blue-500"></i>
          摘要
        </h2>
        
        <div class="bg-white p-6 rounded-lg border border-gray-200 shadow-sm">
          <div class="space-y-4 text-gray-700">
            <p>LSM-tree是现代键值存储系统的核心技术，但其合并操作的粒度设计存在根本性矛盾。现有的两种主流合并粒度方法各有严重缺陷：</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-6">
              <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                <h5 class="font-bold text-red-700 mb-2 flex items-center">
                  <i class="fas fa-times-circle mr-2"></i>Full Merge（完全合并）
                </h5>
                <p class="text-sm">一次合并整个层级，<strong>存储利用率无法超过50%</strong>，浪费大量存储空间。</p>
              </div>
              
              <div class="bg-orange-50 p-4 rounded-lg border border-orange-200">
                <h5 class="font-bold text-orange-700 mb-2 flex items-center">
                  <i class="fas fa-times-circle mr-2"></i>Partial Merge（部分合并）
                </h5>
                <p class="text-sm">每次合并部分文件，<strong>写放大问题严重</strong>，尤其在高存储利用率时性能急剧下降。</p>
              </div>
            </div>
            
            <p>论文作者提出了<strong>Spooky</strong>，一种新型的LSM-tree合并粒度方法，其核心创新包括：</p>
            
            <ul class="list-disc list-inside space-y-2 ml-4 text-gray-700">
              <li><strong>分区合并策略</strong>：将最大层级分区为等大小的文件，并在后续层级上按此边界分区</li>
              <li><strong>完美重叠文件组合并</strong>：一次合并一组完美重叠的文件，减少冗余工作</li>
              <li><strong>SSD友好的I/O模式</strong>：顺序写入和删除数据，降低SSD垃圾回收开销</li>
              <li><strong>混合合并策略</strong>：在较小层级使用Full Merge，在较大层级使用分区合并</li>
            </ul>
            
            <div class="mt-6 p-4 bg-blue-50 rounded-lg">
              <p class="text-blue-700 font-medium">
                <i class="fas fa-lightbulb mr-2"></i>
                <strong>关键发现</strong>：Spooky是唯一能在<strong>高存储利用率（＞80%）</strong>下同时保持<strong>适中写放大（＜15）</strong>的合并粒度策略。
              </p>
            </div>
          </div>
        </div>
      </section>
      
      <!-- 背景与动机 -->
      <section id="background-motivation" class="content-section mobile-optimized mb-12 md:mb-16">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 md:mb-8 flex items-center">
          <i class="fas fa-layer-group mr-3 text-blue-500"></i>
          背景与动机
        </h2>
        
        <div class="space-y-6">
          <!-- LSM-Tree基础知识 -->
          <div class="bg-white p-6 rounded-lg border border-gray-200 shadow-sm">
            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
              <i class="fas fa-database mr-2 text-blue-500"></i>
              LSM-Tree基础知识
            </h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="space-y-4">
                <div class="p-4 bg-gray-50 rounded-lg">
                  <h4 class="font-bold text-gray-700 mb-2">基本结构</h4>
                  <ul class="list-disc list-inside space-y-1 text-sm text-gray-600">
                    <li>数据组织在L个指数增长的层级中</li>
                    <li>Level 0是内存缓冲区（memtable）</li>
                    <li>其他层级存储在持久化设备中</li>
                    <li>层级容量比：T倍增长</li>
                  </ul>
                </div>
                
                <div class="p-4 bg-blue-50 rounded-lg">
                  <h4 class="font-bold text-blue-700 mb-2">合并操作关键作用</h4>
                  <ol class="list-decimal list-inside space-y-1 text-sm text-blue-600">
                    <li>限制查询需要搜索的运行数量</li>
                    <li>丢弃过期条目（相同键的新版本）</li>
                    <li>维持数据的有序性</li>
                  </ol>
                </div>
              </div>
              
              <div class="p-4 bg-purple-50 rounded-lg border border-purple-200">
                <h4 class="font-bold text-purple-700 mb-3">关键性能指标</h4>
                <div class="space-y-3">
                  <div>
                    <div class="flex justify-between items-center mb-1">
                      <span class="font-medium text-purple-600">写放大</span>
                      <span class="text-sm bg-purple-100 text-purple-800 px-2 py-1 rounded">Write Amplification</span>
                    </div>
                    <p class="text-sm text-gray-600">每个数据条目被物理重写的平均次数，消耗存储带宽和寿命</p>
                  </div>
                  
                  <div>
                    <div class="flex justify-between items-center mb-1">
                      <span class="font-medium text-green-600">空间放大</span>
                      <span class="text-sm bg-green-100 text-green-800 px-2 py-1 rounded">Space Amplification</span>
                    </div>
                    <p class="text-sm text-gray-600">LSM-tree占用的存储空间与用户数据大小的比例</p>
                  </div>
                  
                  <div>
                    <div class="flex justify-between items-center mb-1">
                      <span class="font-medium text-blue-600">存储利用率</span>
                      <span class="text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded">Storage Utilization</span>
                    </div>
                    <p class="text-sm text-gray-600">存储设备中可用于存储用户数据的比例</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 技术动机 -->
          <div class="bg-gradient-to-r from-gray-50 to-blue-50 p-6 rounded-lg border border-gray-300">
            <h3 class="text-xl font-bold text-gray-800 mb-4">
              <i class="fas fa-bullseye mr-2 text-red-500"></i>
              研究动机
            </h3>
            
            <div class="space-y-4">
              <p class="text-gray-700">LSM-tree广泛应用于现代数据系统，但其合并粒度的设计存在根本性缺陷：</p>
              
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-white p-4 rounded-lg border border-gray-200">
                  <h4 class="font-bold text-red-600 mb-2">Full Merge的致命缺陷</h4>
                  <p class="text-sm text-gray-600">合并最大层级时需要两倍于用户数据的空间，<strong>存储利用率上限为50%</strong>，这在现代存储系统中是巨大的浪费。</p>
                </div>
                
                <div class="bg-white p-4 rounded-lg border border-gray-200">
                  <h4 class="font-bold text-orange-600 mb-2">Partial Merge的性能问题</h4>
                  <p class="text-sm text-gray-600">随着存储利用率增加，<strong>写放大呈指数增长</strong>，导致性能急剧下降。</p>
                </div>
              </div>
              
              <div class="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                <h4 class="font-bold text-yellow-700 mb-2 flex items-center">
                  <i class="fas fa-question-circle mr-2"></i>
                  核心研究问题
                </h4>
                <p class="text-gray-700">
                  <strong>是否可能设计一种新的合并粒度方法，既能达到高存储利用率（＞80%），又能保持适中的写放大？</strong>
                </p>
              </div>
            </div>
          </div>
        </div>
      </section>
      
      <!-- 问题与挑战 -->
      <section id="challenges" class="content-section mobile-optimized mb-12 md:mb-16">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 md:mb-8 flex items-center">
          <i class="fas fa-exclamation-triangle mr-3 text-blue-500"></i>
          问题与挑战
        </h2>
        
        <div class="space-y-8">
          <!-- 现有合并策略的问题 -->
          <div class="bg-white p-6 rounded-lg border border-gray-200 shadow-sm">
            <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
              <i class="fas fa-bug mr-2 text-red-500"></i>
              现有合并策略的根本缺陷
            </h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
              <!-- Full Merge问题 -->
              <div class="space-y-4">
                <div class="flex items-center">
                  <div class="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3">
                    <i class="fas fa-exclamation text-red-600"></i>
                  </div>
                  <h4 class="text-lg font-bold text-red-700">Full Merge（完全合并）</h4>
                </div>
                
                <div class="p-4 bg-red-50 rounded-lg">
                  <h5 class="font-bold text-red-600 mb-2">核心问题：空间放大</h5>
                  <ul class="list-disc list-inside space-y-1 text-sm text-gray-700">
                    <li>合并最大层级时需要两倍空间</li>
                    <li>存储利用率上限为50%</li>
                    <li>浪费大部分存储容量</li>
                    <li>无法适应大规模数据集</li>
                  </ul>
                </div>
                
                <div class="p-4 bg-gray-50 rounded-lg">
                  <h5 class="font-bold text-gray-700 mb-2">典型系统</h5>
                  <div class="flex flex-wrap gap-2">
                    <span class="bg-gray-200 text-gray-800 px-3 py-1 rounded-full text-sm">Cassandra</span>
                    <span class="bg-gray-200 text-gray-800 px-3 py-1 rounded-full text-sm">HBase</span>
                    <span class="bg-gray-200 text-gray-800 px-3 py-1 rounded-full text-sm">RocksDB Universal Compaction</span>
                  </div>
                </div>
              </div>
              
              <!-- Partial Merge问题 -->
              <div class="space-y-4">
                <div class="flex items-center">
                  <div class="w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center mr-3">
                    <i class="fas fa-exclamation text-orange-600"></i>
                  </div>
                  <h4 class="text-lg font-bold text-orange-700">Partial Merge（部分合并）</h4>
                </div>
                
                <div class="p-4 bg-orange-50 rounded-lg">
                  <h5 class="font-bold text-orange-600 mb-2">核心问题：写放大</h5>
                  <ul class="list-disc list-inside space-y-1 text-sm text-gray-700">
                    <li>文件键范围不完全重叠导致冗余重写</li>
                    <li>同时进行的合并导致文件物理交错</li>
                    <li>SSD垃圾回收效率低下</li>
                    <li>高存储利用率时性能急剧下降</li>
                  </ul>
                </div>
                
                <div class="p-4 bg-gray-50 rounded-lg">
                  <h5 class="font-bold text-gray-700 mb-2">典型系统</h5>
                  <div class="flex flex-wrap gap-2">
                    <span class="bg-gray-200 text-gray-800 px-3 py-1 rounded-full text-sm">LevelDB</span>
                    <span class="bg-gray-200 text-gray-800 px-3 py-1 rounded-full text-sm">RocksDB默认策略</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 技术挑战详解 -->
          <div class="bg-gradient-to-r from-gray-50 to-blue-50 p-6 rounded-lg border border-gray-300">
            <h3 class="text-xl font-bold text-gray-800 mb-6">
              <i class="fas fa-cogs mr-2 text-blue-500"></i>
              关键技术挑战分析
            </h3>
            
            <div class="space-y-6">
              <!-- 图1技术解释 -->
              <details class="technical-details bg-white rounded-lg p-4 md:p-6 mb-6 mt-6 border border-gray-300">
                <summary class="cursor-pointer font-semibold text-lg md:text-xl text-gray-800 hover:text-blue-600 transition-colors py-2">
                  <i class="fas fa-chart-line mr-2 text-green-500"></i>技术细节：图1 - 存储利用率与写放大对比
                </summary>
                
                <div class="mt-6 space-y-6">
                  <!-- 原图展示部分 -->
                  <div class="original-figure-container">
                    <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-4 gap-2">
                      <h5 class="font-semibold text-gray-700 text-base md:text-lg">
                        <i class="fas fa-image mr-2 text-blue-500"></i>
                        原图 1: 存储利用率与写放大对比
                      </h5>
                      <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded self-start sm:self-auto">论文原图</span>
                    </div>
                    
                    <!-- 原图占位符 -->
                    <div class="image-placeholder bg-gradient-to-br from-gray-100 to-gray-200 p-6 md:p-8 rounded-lg text-center border-2 border-dashed border-gray-300">
                      <img src="./images/fig1.png" alt="论文图1: Full Merge和Partial Merge在存储利用率与写放大之间的对比" class="max-w-full h-auto rounded-lg">
                    </div>
                    
                    <!-- 原图图注 -->
                    <div class="mt-4 text-sm text-gray-600 bg-gray-50 p-3 rounded border">
                      <strong>原图图注:</strong> 现有LSM-trees无法在保持适中写放大的同时达到高存储利用率。
                    </div>
                  </div>
                  
                  <!-- 技术解释部分 -->
                  <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <h5 class="font-semibold text-blue-700 mb-3 flex items-center text-base md:text-lg">
                      <i class="fas fa-info-circle mr-2"></i>技术解释：
                    </h5>
                    <ul class="list-disc list-inside space-y-2 text-sm md:text-base text-gray-700">
                      <li><strong>Partial Merge问题:</strong> 随着存储利用率增加，写放大呈指数增长（图中红色曲线）</li>
                      <li><strong>Full Merge问题:</strong> 存储利用率无法超过50%，浪费大量存储空间（图中蓝色曲线）</li>
                      <li><strong>根本矛盾:</strong> 现有方法无法同时达到高存储利用率和适中写放大</li>
                      <li><strong>Spooky目标:</strong> 在图中绿色区域，同时实现高存储利用率和低写放大</li>
                    </ul>
                  </div>
                  
                  <!-- 设计实现部分 -->
                  <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                    <h5 class="font-semibold text-green-700 mb-3 flex items-center text-base md:text-lg">
                      <i class="fas fa-cogs mr-2"></i>设计意义：
                    </h5>
                    <div class="text-sm md:text-base text-gray-700 space-y-3">
                      <div>
                        <strong class="text-green-700">问题识别:</strong>
                        <p>图1清晰地展示了现有LSM-tree合并粒度设计中的根本矛盾，为Spooky的设计提供了明确目标。</p>
                      </div>
                      <div>
                        <strong class="text-green-700">性能指标:</strong>
                        <p>存储利用率（横轴）与写放大（纵轴）的权衡关系是评估LSM-tree设计的关键指标。</p>
                      </div>
                    </div>
                  </div>
                </div>
              </details>
              
              <!-- 数学模型分析 -->
              <div class="bg-white p-6 rounded-lg border border-gray-200">
                <h4 class="font-bold text-gray-700 mb-4">
                  <i class="fas fa-calculator mr-2 text-purple-500"></i>
                  数学模型分析
                </h4>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div class="p-4 bg-purple-50 rounded-lg">
                    <h5 class="font-bold text-purple-700 mb-3">写放大模型</h5>
                    <div class="space-y-4">
                      <div class="p-3 bg-white rounded border">
                        <div class="font-mono text-sm text-purple-800 mb-1">Full Merge:</div>
                        <div class="text-lg font-bold text-center text-purple-600">WA = (T-1)/2 × L</div>
                        <p class="text-xs text-gray-500 mt-2">T: 大小比例, L: 层级数量</p>
                      </div>
                      
                      <div class="p-3 bg-white rounded border">
                        <div class="font-mono text-sm text-orange-800 mb-1">Partial Merge:</div>
                        <div class="text-lg font-bold text-center text-orange-600">WA = (T+1)/2 × L</div>
                        <p class="text-xs text-gray-500 mt-2">额外开销：+1文件冗余重写</p>
                      </div>
                    </div>
                  </div>
                  
                  <div class="p-4 bg-green-50 rounded-lg">
                    <h5 class="font-bold text-green-700 mb-3">空间放大模型</h5>
                    <div class="space-y-4">
                      <div class="p-3 bg-white rounded border">
                        <div class="font-mono text-sm text-blue-800 mb-1">Full Merge:</div>
                        <div class="text-lg font-bold text-center text-blue-600">SA = 2 + 1/(T-1)</div>
                        <p class="text-xs text-gray-500 mt-2">存储利用率上限：50%</p>
                      </div>
                      
                      <div class="p-3 bg-white rounded border">
                        <div class="font-mono text-sm text-green-800 mb-1">Partial Merge:</div>
                        <div class="text-lg font-bold text-center text-green-600">SA = 1 + 1/(T-1)</div>
                        <p class="text-xs text-gray-500 mt-2">可达到高存储利用率</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 问题总结 -->
          <div class="bg-gradient-to-r from-red-50 to-orange-50 p-6 rounded-lg border border-red-200">
            <h4 class="font-bold text-red-700 mb-4 flex items-center">
              <i class="fas fa-exclamation-triangle mr-2"></i>
              问题总结
            </h4>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="p-4 bg-white rounded-lg">
                <h5 class="font-bold text-red-600 mb-3">Full Merge的致命缺陷</h5>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                  <li><strong>空间浪费严重</strong>：存储利用率上限50%</li>
                  <li><strong>不适合大规模数据</strong>：需要双倍空间进行合并</li>
                  <li><strong>硬件利用率低</strong>：浪费昂贵的SSD容量</li>
                </ul>
              </div>
              
              <div class="p-4 bg-white rounded-lg">
                <h5 class="font-bold text-orange-600 mb-3">Partial Merge的性能瓶颈</h5>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                  <li><strong>写放大问题严重</strong>：高存储利用率时指数增长</li>
                  <li><strong>SSD垃圾回收低效</strong>：文件物理交错增加GC开销</li>
                  <li><strong>性能不稳定</strong>：存储利用率增加导致性能下降</li>
                </ul>
              </div>
            </div>
            
            <div class="mt-6 p-4 bg-yellow-100 border border-yellow-300 rounded-lg">
              <p class="text-yellow-800 font-bold">
                <i class="fas fa-question-circle mr-2"></i>
                <strong>核心研究问题</strong>：能否设计一种新的合并粒度方法，同时解决空间放大和写放大问题？
              </p>
            </div>
          </div>
        </div>
      </section>
      
      <!-- 设计与实现 -->
      <section id="design-implementation" class="content-section mobile-optimized mb-12 md:mb-16">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 md:mb-8 flex items-center">
          <i class="fas fa-cogs mr-3 text-blue-500"></i>
          设计与实现
        </h2>
        
        <div class="space-y-8">
          <!-- Spooky整体设计 -->
          <div class="bg-white p-6 rounded-lg border border-gray-200 shadow-sm">
            <h3 class="text-xl font-bold text-gray-800 mb-6">
              <i class="fas fa-ghost mr-2 text-purple-500"></i>
              Spooky整体设计
            </h3>
            
            <div class="space-y-6">
              <!-- 图8技术解释 -->
              <details class="technical-details bg-gray-50 rounded-lg p-4 md:p-6 mb-6">
                <summary class="cursor-pointer font-semibold text-lg md:text-xl text-gray-800 hover:text-blue-600 transition-colors py-2">
                  <i class="fas fa-sitemap mr-2 text-blue-500"></i>技术细节：图8 - Spooky六条设计原则
                </summary>
                
                <div class="mt-6 space-y-6">
                  <!-- 原图展示部分 -->
                  <div class="original-figure-container">
                    <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-4 gap-2">
                      <h5 class="font-semibold text-gray-700 text-base md:text-lg">
                        <i class="fas fa-image mr-2 text-blue-500"></i>
                        原图 8: Spooky六条设计原则
                      </h5>
                      <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded self-start sm:self-auto">论文原图</span>
                    </div>
                    
                    <!-- 原图占位符 -->
                    <div class="image-placeholder bg-gradient-to-br from-gray-100 to-gray-200 p-6 md:p-8 rounded-lg text-center border-2 border-dashed border-gray-300">
                      <img src="./images/fig8.png" alt="论文图8: Spooky的六条设计原则" class="max-w-full h-auto rounded-lg">
                    </div>
                    
                    <!-- 原图图注 -->
                    <div class="mt-4 text-sm text-gray-600 bg-gray-50 p-3 rounded border">
                      <strong>原图图注:</strong> Spooky通过引入并遵循六条合并粒度原则来同时限制空间放大和写放大。
                    </div>
                  </div>
                  
                  <!-- 技术解释部分 -->
                  <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <h5 class="font-semibold text-blue-700 mb-3 flex items-center text-base md:text-lg">
                      <i class="fas fa-info-circle mr-2"></i>设计原则详解：
                    </h5>
                    <ol class="list-decimal list-inside space-y-3 text-sm md:text-base text-gray-700">
                      <li><strong>最大层级分区:</strong> 将最大层级分区为等大小的文件</li>
                      <li><strong>后续层级分区:</strong> 根据最大层级的文件边界分区后续几个较大层级</li>
                      <li><strong>分区合并:</strong> 一次合并一组完美重叠的文件</li>
                      <li><strong>较小层级完全合并:</strong> 在较小层级使用完全预占合并</li>
                      <li><strong>限制并发写入:</strong> 限制同时写入SSD的文件数量</li>
                      <li><strong>顺序I/O模式:</strong> 在每个层级内顺序写入和删除数据</li>
                    </ol>
                  </div>
                </div>
              </details>
              
              <!-- 六条设计原则可视化 -->
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div class="tech-card bg-blue-50 p-4 rounded-lg border border-blue-200">
                  <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mb-3">
                    <span class="font-bold text-blue-600">1</span>
                  </div>
                  <h4 class="font-bold text-blue-700 text-lg mb-2">最大层级分区</h4>
                  <p class="text-sm text-gray-700">将最大层级分区为等大小的文件</p>
                </div>
                
                <div class="tech-card bg-green-50 p-4 rounded-lg border border-green-200">
                  <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mb-3">
                    <span class="font-bold text-green-600">2</span>
                  </div>
                  <h4 class="font-bold text-green-700 text-lg mb-2">后续层级分区</h4>
                  <p class="text-sm text-gray-700">基于最大层级的文件边界分区后续层级</p>
                </div>
                
                <div class="tech-card bg-purple-50 p-4 rounded-lg border border-purple-200">
                  <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center mb-3">
                    <span class="font-bold text-purple-600">3</span>
                  </div>
                  <h4 class="font-bold text-purple-700 text-lg mb-2">分区合并</h4>
                  <p class="text-sm text-gray-700">一次合并一组完美重叠的文件</p>
                </div>
                
                <div class="tech-card bg-red-50 p-4 rounded-lg border border-red-200">
                  <div class="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mb-3">
                    <span class="font-bold text-red-600">4</span>
                  </div>
                  <h4 class="font-bold text-red-700 text-lg mb-2">较小层级完全合并</h4>
                  <p class="text-sm text-gray-700">在较小层级使用完全预占合并</p>
                </div>
                
                <div class="tech-card bg-yellow-50 p-4 rounded-lg border border-yellow-200">
                  <div class="w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center mb-3">
                    <span class="font-bold text-yellow-600">5</span>
                  </div>
                  <h4 class="font-bold text-yellow-700 text-lg mb-2">限制并发写入</h4>
                  <p class="text-sm text-gray-700">限制同时写入SSD的文件数量</p>
                </div>
                
                <div class="tech-card bg-indigo-50 p-4 rounded-lg border border-indigo-200">
                  <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center mb-3">
                    <span class="font-bold text-indigo-600">6</span>
                  </div>
                  <h4 class="font-bold text-indigo-700 text-lg mb-2">顺序I/O模式</h4>
                  <p class="text-sm text-gray-700">在每个层级内顺序写入和删除数据</p>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 两级Spooky设计 -->
          <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-lg border border-blue-300">
            <h3 class="text-xl font-bold text-gray-800 mb-6">
              <i class="fas fa-layer-group mr-2 text-blue-500"></i>
              两级Spooky（2L-Spooky）
            </h3>
            
            <div class="space-y-6">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-4">
                  <h4 class="font-bold text-blue-700">核心设计</h4>
                  <p class="text-gray-700">在最大两个层级（L和L-1）上执行分区合并：</p>
                  
                  <ul class="list-disc list-inside space-y-2 text-gray-600">
                    <li><strong>Level L:</strong> 分区为至少T个等大小文件</li>
                    <li><strong>Level L-1:</strong> 按Level L的文件边界分区</li>
                    <li><strong>较小层级:</strong> 使用完全预占合并</li>
                  </ul>
                  
                  <div class="p-4 bg-white rounded-lg border border-gray-200 mt-4">
                    <h5 class="font-bold text-gray-700 mb-2">分区合并示例</h5>
                    <div class="flex items-center justify-center space-x-4">
                      <div class="text-center">
                        <div class="w-16 h-8 bg-blue-200 rounded mb-2"></div>
                        <span class="text-xs">Level L-1文件</span>
                      </div>
                      <i class="fas fa-arrow-right text-gray-400"></i>
                      <div class="text-center">
                        <div class="w-16 h-8 bg-blue-300 rounded mb-2"></div>
                        <span class="text-xs">Level L对应文件</span>
                      </div>
                      <i class="fas fa-arrow-right text-gray-400"></i>
                      <div class="text-center">
                        <div class="w-16 h-8 bg-blue-400 rounded mb-2"></div>
                        <span class="text-xs">合并结果</span>
                      </div>
                    </div>
                  </div>
                </div>
                
                <div class="p-4 bg-white rounded-lg border border-gray-200">
                  <h4 class="font-bold text-purple-700 mb-4">性能模型</h4>
                  
                  <div class="space-y-4">
                    <div class="p-3 bg-purple-50 rounded">
                      <div class="text-sm font-medium text-purple-600 mb-1">写放大</div>
                      <div class="font-mono text-lg font-bold text-center text-purple-800">WA = L×(T-1)/2 + 1</div>
                    </div>
                    
                    <div class="p-3 bg-green-50 rounded">
                      <div class="text-sm font-medium text-green-600 mb-1">空间放大</div>
                      <div class="font-mono text-lg font-bold text-center text-green-800">SA = 1 + 1/T + 1/(T-1)</div>
                    </div>
                    
                    <div class="p-3 bg-blue-50 rounded">
                      <div class="text-sm font-medium text-blue-600 mb-1">瞬态空间放大</div>
                      <div class="font-mono text-lg font-bold text-center text-blue-800">1/T</div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- 图9技术解释 -->
              <details class="technical-details bg-white rounded-lg p-4 md:p-6 mt-4 border border-gray-300">
                <summary class="cursor-pointer font-semibold text-lg md:text-xl text-gray-800 hover:text-blue-600 transition-colors py-2">
                  <i class="fas fa-chart-bar mr-2 text-green-500"></i>技术细节：图9 - 2L-Spooky性能分析
                </summary>
                
                <div class="mt-6 space-y-6">
                  <!-- 原图展示部分 -->
                  <div class="original-figure-container">
                    <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-4 gap-2">
                      <h5 class="font-semibold text-gray-700 text-base md:text-lg">
                        <i class="fas fa-image mr-2 text-blue-500"></i>
                        原图 9: 2L-Spooky性能分析
                      </h5>
                      <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded self-start sm:self-auto">论文原图</span>
                    </div>
                    
                    <!-- 原图占位符 -->
                    <div class="image-placeholder bg-gradient-to-br from-gray-100 to-gray-200 p-6 md:p-8 rounded-lg text-center border-2 border-dashed border-gray-300">
                      <img src="./images/fig9.png" alt="论文图9: 2L-Spooky相比Full Merge和Partial Merge在写放大和存储利用率上的改进" class="max-w-full h-auto rounded-lg">
                    </div>
                    
                    <!-- 原图图注 -->
                    <div class="mt-4 text-sm text-gray-600 bg-gray-50 p-3 rounded border">
                      <strong>原图图注:</strong> 2L-Spooky显著改善了相对于Full Merge的空间放大和相对于Partial Merge的写放大。
                    </div>
                  </div>
                  
                  <!-- 技术解释部分 -->
                  <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <h5 class="font-semibold text-blue-700 mb-3 flex items-center text-base md:text-lg">
                      <i class="fas fa-info-circle mr-2"></i>技术解释：
                    </h5>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm md:text-base">
                      <div>
                        <strong class="text-blue-700">图A（写放大）:</strong>
                        <ul class="list-disc list-inside mt-1 text-gray-700">
                          <li>2L-Spooky写放大接近Full Merge</li>
                          <li>显著优于Partial Merge</li>
                          <li>随T增大，优势更明显</li>
                        </ul>
                      </div>
                      <div>
                        <strong class="text-green-700">图B（存储利用率）:</strong>
                        <ul class="list-disc list-inside mt-1 text-gray-700">
                          <li>2L-Spooky存储利用率高于Full Merge</li>
                          <li>相比Partial Merge略低10%</li>
                          <li>在T=5时达到约75%利用率</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </details>
            </div>
          </div>
          
          <!-- 广义Spooky设计 -->
          <div class="bg-white p-6 rounded-lg border border-gray-200 shadow-sm">
            <h3 class="text-xl font-bold text-gray-800 mb-6">
              <i class="fas fa-expand-alt mr-2 text-purple-500"></i>
              广义Spooky（Generalized Spooky）
            </h3>
            
            <div class="space-y-6">
              <div class="p-4 bg-purple-50 rounded-lg border border-purple-200">
                <h4 class="font-bold text-purple-700 mb-3">核心扩展：参数X</h4>
                <p class="text-gray-700">引入参数X，表示开始基于最大层级文件边界分区的最小层级：</p>
                
                <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div class="p-3 bg-white rounded border border-purple-300">
                    <div class="text-center font-bold text-purple-600 mb-2">X = L</div>
                    <p class="text-xs text-gray-600">退化为Full Merge</p>
                  </div>
                  
                  <div class="p-3 bg-white rounded border border-purple-300">
                    <div class="text-center font-bold text-purple-600 mb-2">X = L-1</div>
                    <p class="text-xs text-gray-600">2L-Spooky（两级）</p>
                  </div>
                  
                  <div class="p-3 bg-white rounded border border-purple-300">
                    <div class="text-center font-bold text-purple-600 mb-2">X = L-2</div>
                    <p class="text-xs text-gray-600">三级Spooky（推荐）</p>
                  </div>
                </div>
              </div>
              
              <!-- 图10技术解释 -->
              <details class="technical-details bg-gray-50 rounded-lg p-4 md:p-6">
                <summary class="cursor-pointer font-semibold text-lg md:text-xl text-gray-800 hover:text-blue-600 transition-colors py-2">
                  <i class="fas fa-project-diagram mr-2 text-blue-500"></i>技术细节：图10 - 分区预占合并
                </summary>
                
                <div class="mt-6 space-y-6">
                  <!-- 原图展示部分 -->
                  <div class="original-figure-container">
                    <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-4 gap-2">
                      <h5 class="font-semibold text-gray-700 text-base md:text-lg">
                        <i class="fas fa-image mr-2 text-blue-500"></i>
                        原图 10: 分区预占合并
                      </h5>
                      <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded self-start sm:self-auto">论文原图</span>
                    </div>
                    
                    <!-- 原图占位符 -->
                    <div class="image-placeholder bg-gradient-to-br from-gray-100 to-gray-200 p-6 md:p-8 rounded-lg text-center border-2 border-dashed border-gray-300">
                      <img src="./images/fig10.png" alt="论文图10: Spooky在较大层级上执行分区预占合并以降低写放大" class="max-w-full h-auto rounded-lg">
                    </div>
                    
                    <!-- 原图图注 -->
                    <div class="mt-4 text-sm text-gray-600 bg-gray-50 p-3 rounded border">
                      <strong>原图图注:</strong> Spooky在较大层级上执行分区预占合并以降低写放大。
                    </div>
                  </div>
                  
                  <!-- 技术解释部分 -->
                  <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                    <h5 class="font-semibold text-green-700 mb-3 flex items-center text-base md:text-lg">
                      <i class="fas fa-cogs mr-2"></i>设计实现：
                    </h5>
                    <div class="text-sm md:text-base text-gray-700 space-y-3">
                      <div>
                        <strong class="text-green-700">预占合并优化:</strong>
                        <p>结合预占合并和分区合并的思想，当数据量不超过下一层级容量时，合并到中间层级而非最大层级，减少数据重写次数。</p>
                      </div>
                      <div>
                        <strong class="text-green-700">示例分析:</strong>
                        <p>图A：数据量小，合并到Level L-1；图B：数据量大，直接合并到Level L。</p>
                      </div>
                    </div>
                  </div>
                </div>
              </details>
              
              <!-- 性能模型 -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="p-4 bg-blue-50 rounded-lg">
                  <h5 class="font-bold text-blue-700 mb-3">广义Spooky性能模型</h5>
                  
                  <div class="space-y-4">
                    <div class="p-3 bg-white rounded border">
                      <div class="text-sm font-medium text-blue-600 mb-1">写放大</div>
                      <div class="font-mono text-base text-center text-blue-800">WA = L×(T-1)/2 + 1 (X < L)</div>
                    </div>
                    
                    <div class="p-3 bg-white rounded border">
                      <div class="text-sm font-medium text-green-600 mb-1">空间放大</div>
                      <div class="font-mono text-base text-center text-green-800">SA = 1 + 1/T^{L-X} + 1/(T-1)</div>
                    </div>
                    
                    <div class="p-3 bg-white rounded border">
                      <div class="text-sm font-medium text-purple-600 mb-1">最大文件数</div>
                      <div class="font-mono text-base text-center text-purple-800">F = (L-X)×T^{L-X} + (X-1)</div>
                    </div>
                  </div>
                </div>
                
                <div class="p-4 bg-yellow-50 rounded-lg">
                  <h5 class="font-bold text-yellow-700 mb-3">推荐配置分析</h5>
                  
                  <div class="space-y-3">
                    <div class="flex items-center">
                      <i class="fas fa-check-circle text-green-500 mr-2"></i>
                      <span class="text-sm text-gray-700"><strong>X = L-2</strong>（三级Spooky）提供最佳平衡</span>
                    </div>
                    
                    <div class="flex items-center">
                      <i class="fas fa-exclamation-triangle text-orange-500 mr-2"></i>
                      <span class="text-sm text-gray-700"><strong>X太小</strong>（如L-4）可能导致文件数过多</span>
                    </div>
                    
                    <div class="flex items-center">
                      <i class="fas fa-times-circle text-red-500 mr-2"></i>
                      <span class="text-sm text-gray-700"><strong>X = L-1</strong>可能空间不足导致系统崩溃</span>
                    </div>
                  </div>
                  
                  <div class="mt-4 p-3 bg-white rounded border border-yellow-300">
                    <p class="text-sm text-gray-600">
                      <strong>实践建议：</strong>大多数情况下设置X = L-2，在瞬态空间放大和文件数量之间取得良好平衡。
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 实现细节 -->
          <div class="bg-gradient-to-r from-gray-50 to-green-50 p-6 rounded-lg border border-gray-300">
            <h3 class="text-xl font-bold text-gray-800 mb-6">
              <i class="fas fa-code mr-2 text-green-500"></i>
              实现细节
            </h3>
            
            <div class="space-y-6">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-4">
                  <h4 class="font-bold text-green-700">RocksDB集成</h4>
                  <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li>基于<code>compaction_picker.h</code>抽象类实现</li>
                    <li>封装在单个文件中，工程简洁</li>
                    <li>保持其他系统组件不变</li>
                  </ul>
                  
                  <div class="p-4 bg-white rounded-lg border border-gray-200 mt-4">
                    <h5 class="font-bold text-gray-700 mb-2">层级映射</h5>
                    <p class="text-sm text-gray-600">处理RocksDB rLevel与理论层级的差异：</p>
                    <ul class="list-disc list-inside mt-2 text-xs text-gray-600">
                      <li>rLevel 0：特殊层级，文件可能重叠</li>
                      <li>rLevel 0参数：α=4, β=4, γ=9</li>
                      <li>支持分层和混合策略的层级映射</li>
                    </ul>
                  </div>
                </div>
                
                <div class="space-y-4">
                  <h4 class="font-bold text-blue-700">并发控制</h4>
                  <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li>利用RocksDB后台线程执行合并</li>
                    <li>支持子合并（sub-compaction）并行化</li>
                    <li>最多三个并发合并操作</li>
                  </ul>
                  
                  <div class="p-4 bg-white rounded-lg border border-gray-200 mt-4">
                    <h5 class="font-bold text-gray-700 mb-2">避免阻塞</h5>
                    <p class="text-sm text-gray-600">实现rLevel 0内部合并防止系统停滞：</p>
                    <div class="mt-2 text-xs text-gray-500">
                      <div class="flex items-center">
                        <i class="fas fa-check text-green-500 mr-2"></i>
                        <span>当rLevel 0有≥4个等大小连续文件时触发</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- 算法2伪代码展示 -->
              <div class="bg-white p-6 rounded-lg border border-gray-200">
                <h4 class="font-bold text-purple-700 mb-4 flex items-center">
                  <i class="fas fa-code-branch mr-2"></i>
                  Spooky核心算法（算法2）
                </h4>
                
                <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto">
                  <pre class="font-mono text-sm">
Algorithm 2: Spooky Compaction Workflow
Input: Parameter X (division level)
Output: Compaction decision

1: function SPOOKY_COMPACTION
2:   // Full preemptive merge at smaller levels
3:   q ← smallest level in [1, X-1] that won't reach capacity
4:   if q exists then
5:     Compact all data in levels 0 to q into level q
6:     if q < X then
7:       Store as one file
8:     else
9:       Partition based on file boundaries at level L
10:    end if
11:    return
12:  end if
13:  
14:  // Partitioned preemptive merge
15:  if level X is full then
16:    z ← smallest level in [X+1, L] that won't reach capacity
17:    for each overlapping file group in levels X to z do
18:      Compact into level z
19:      if z < L then
20:        Partition based on file boundaries at level L
21:      end if
22:    end for
23:  end if
24: end function</pre>
                </div>
                
                <div class="mt-4 text-sm text-gray-600">
                  <p><strong>算法说明：</strong>Spooky算法包含两个主要部分：(1)在较小层级执行完全预占合并；(2)在较大层级执行分区预占合并。</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      
      <!-- 测试与评估 -->
      <section id="evaluation" class="content-section mobile-optimized mb-12 md:mb-16">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 md:mb-8 flex items-center">
          <i class="fas fa-chart-line mr-3 text-blue-500"></i>
          测试与评估
        </h2>
        
        <div class="space-y-8">
          <!-- 实验设置 -->
          <div class="bg-white p-6 rounded-lg border border-gray-200 shadow-sm">
            <h3 class="text-xl font-bold text-gray-800 mb-6">
              <i class="fas fa-flask mr-2 text-blue-500"></i>
              实验设置
            </h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="space-y-4">
                <h4 class="font-bold text-blue-700">硬件配置</h4>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                  <li><strong>CPU：</strong>11th Gen Intel i7-11700 (16核，2.50GHz)</li>
                  <li><strong>内存：</strong>64GB DDR</li>
                  <li><strong>存储：</strong>960GB Samsung NVMe SSD</li>
                  <li><strong>操作系统：</strong>Ubuntu 18.04.4 LTS</li>
                </ul>
              </div>
              
              <div class="space-y-4">
                <h4 class="font-bold text-green-700">软件配置</h4>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                  <li><strong>数据库：</strong>RocksDB (db_bench基准测试工具)</li>
                  <li><strong>数据条目：</strong>16B键 + 512B值</li>
                  <li><strong>合并策略：</strong>默认使用leveling</li>
                  <li><strong>大小比例T：</strong>默认设为5</li>
                  <li><strong>线程配置：</strong>1个应用线程 + 16个后台线程</li>
                </ul>
              </div>
            </div>
          </div>
          
          <!-- 主要实验结果 -->
          <div class="bg-gradient-to-r from-blue-50 to-green-50 p-6 rounded-lg border border-blue-300">
            <h3 class="text-xl font-bold text-gray-800 mb-6">
              <i class="fas fa-chart-bar mr-2 text-green-500"></i>
              主要实验结果
            </h3>
            
            <!-- 图13技术解释 -->
            <details class="technical-details bg-white rounded-lg p-4 md:p-6 mb-6 border border-gray-300">
              <summary class="cursor-pointer font-semibold text-lg md:text-xl text-gray-800 hover:text-blue-600 transition-colors py-2">
                <i class="fas fa-chart-area mr-2 text-blue-500"></i>技术细节：图13 - Spooky综合性能评估
              </summary>
              
              <div class="mt-6 space-y-6">
                <!-- 原图展示部分 -->
                <div class="original-figure-container">
                  <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-4 gap-2">
                    <h5 class="font-semibold text-gray-700 text-base md:text-lg">
                      <i class="fas fa-image mr-2 text-blue-500"></i>
                      原图 13: Spooky综合性能评估
                    </h5>
                    <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded self-start sm:self-auto">论文原图</span>
                  </div>
                  
                  <!-- 原图占位符 -->
                  <div class="image-placeholder bg-gradient-to-br from-gray-100 to-gray-200 p-6 md:p-8 rounded-lg text-center border-2 border-dashed border-gray-300">
                    <img src="./images/fig13.png" alt="论文图13: Spooky在存储利用率、写放大和性能方面的综合评估" class="max-w-full h-auto rounded-lg">
                  </div>
                  
                  <!-- 原图图注 -->
                  <div class="mt-4 text-sm text-gray-600 bg-gray-50 p-3 rounded border">
                    <strong>原图图注:</strong> Full Merge表现出低写放大但无法达到高存储利用率。Partial Merge可以达到高存储利用率但代价是高写放大。Spooky是唯一同时实现高存储利用率、适中写放大和良好性能的合并粒度方案。
                  </div>
                </div>
                
                <!-- 技术解释部分 -->
                <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                  <h5 class="font-semibold text-blue-700 mb-3 flex items-center text-base md:text-lg">
                    <i class="fas fa-info-circle mr-2"></i>图表解释：
                  </h5>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm md:text-base">
                    <div>
                      <strong class="text-blue-700">图A（物理数据大小）:</strong>
                      <ul class="list-disc list-inside mt-1 text-gray-700">
                        <li>Spooky和Partial Merge支持644GB逻辑数据</li>
                        <li>Full Merge仅支持369GB逻辑数据</li>
                        <li>Spooky瞬态空间放大远小于Full Merge</li>
                      </ul>
                    </div>
                    <div>
                      <strong class="text-green-700">图B（合并写放大）:</strong>
                      <ul class="list-disc list-inside mt-1 text-gray-700">
                        <li>Spooky写放大比Partial Merge低30%</li>
                        <li>支持相同数据量下性能更优</li>
                      </ul>
                    </div>
                    <div>
                      <strong class="text-purple-700">图C（垃圾回收写放大）:</strong>
                      <ul class="list-disc list-inside mt-1 text-gray-700">
                        <li>Spooky GC写放大比Partial Merge低2倍以上</li>
                        <li>Full Merge无GC开销（数据量小）</li>
                      </ul>
                    </div>
                    <div>
                      <strong class="text-red-700">图D（总写放大）:</strong>
                      <ul class="list-disc list-inside mt-1 text-gray-700">
                        <li>Spooky总写放大比Partial Merge低2.5倍</li>
                        <li>同时保持高存储利用率</li>
                      </ul>
                    </div>
                  </div>
                </div>
                
                <!-- 性能分析部分 -->
                <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                  <h5 class="font-semibold text-purple-700 mb-3 flex items-center text-base md:text-lg">
                    <i class="fas fa-chart-line mr-2"></i>性能分析：
                  </h5>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm md:text-base">
                    <div>
                      <strong class="text-purple-700">读写性能（图E）:</strong>
                      <ul class="list-disc list-inside mt-1 text-gray-700">
                        <li>Spooky更新吞吐量比Partial Merge提高约2.5倍</li>
                        <li>查询性能显著改善（后台写放大降低）</li>
                        <li>99.9百分位延迟稳定（图F）</li>
                      </ul>
                    </div>
                    <div>
                      <strong class="text-purple-700">倾斜负载（图G-H）:</strong>
                      <ul class="list-disc list-inside mt-1 text-gray-700">
                        <li>Spooky在Zipfian负载下表现优异</li>
                        <li>写放大改善显著</li>
                        <li>吞吐量几乎匹配Full Merge但存储2倍数据</li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </details>
            
            <!-- 关键结果总结 -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
              <div class="p-4 bg-green-50 rounded-lg border border-green-200">
                <div class="text-center text-3xl font-bold text-green-600 mb-2">＞2.5×</div>
                <p class="text-center text-sm font-medium text-green-700">总写放大降低</p>
                <p class="text-xs text-gray-600 text-center mt-2">相比Partial Merge</p>
              </div>
              
              <div class="p-4 bg-blue-50 rounded-lg border border-blue-200">
                <div class="text-center text-3xl font-bold text-blue-600 mb-2">＞2×</div>
                <p class="text-center text-sm font-medium text-blue-700">空间放大改善</p>
                <p class="text-xs text-gray-600 text-center mt-2">相比Full Merge</p>
              </div>
              
              <div class="p-4 bg-purple-50 rounded-lg border border-purple-200">
                <div class="text-center text-3xl font-bold text-purple-600 mb-2">80%+</div>
                <p class="text-center text-sm font-medium text-purple-700">存储利用率</p>
                <p class="text-xs text-gray-600 text-center mt-2">同时保持适中写放大</p>
              </div>
            </div>
          </div>
          
          <!-- 扩展实验 -->
          <div class="bg-white p-6 rounded-lg border border-gray-200 shadow-sm">
            <h3 class="text-xl font-bold text-gray-800 mb-6">
              <i class="fas fa-expand-arrows-alt mr-2 text-orange-500"></i>
              扩展实验分析
            </h3>
            
            <div class="space-y-6">
              <!-- 图14技术解释 -->
              <details class="technical-details bg-gray-50 rounded-lg p-4 md:p-6 mb-4">
                <summary class="cursor-pointer font-semibold text-lg md:text-xl text-gray-800 hover:text-blue-600 transition-colors py-2">
                  <i class="fas fa-balance-scale mr-2 text-blue-500"></i>技术细节：图14 - Spooky在不同合并策略下的表现
                </summary>
                
                <div class="mt-6 space-y-6">
                  <!-- 原图展示部分 -->
                  <div class="original-figure-container">
                    <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-4 gap-2">
                      <h5 class="font-semibold text-gray-700 text-base md:text-lg">
                        <i class="fas fa-image mr-2 text-blue-500"></i>
                        原图 14: Spooky在不同合并策略下的表现
                      </h5>
                      <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded self-start sm:self-auto">论文原图</span>
                    </div>
                    
                    <!-- 原图占位符 -->
                    <div class="image-placeholder bg-gradient-to-br from-gray-100 to-gray-200 p-6 md:p-8 rounded-lg text-center border-2 border-dashed border-gray-300">
                      <img src="./images/fig14.png" alt="论文图14: Spooky在多种合并策略下的兼容性和X参数调优" class="max-w-full h-auto rounded-lg">
                    </div>
                    
                    <!-- 原图图注 -->
                    <div class="mt-4 text-sm text-gray-600 bg-gray-50 p-3 rounded border">
                      <strong>原图图注:</strong> Spooky兼容多种合并策略，包括分层和延迟分层（Parts A-C）。Spooky通常在X=L-2时表现最佳，以平衡瞬态空间放大和打开文件数量（Part D）。
                    </div>
                  </div>
                  
                  <!-- 技术解释部分 -->
                  <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <h5 class="font-semibold text-blue-700 mb-3 flex items-center text-base md:text-lg">
                      <i class="fas fa-info-circle mr-2"></i>技术解释：
                    </h5>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm md:text-base">
                      <div>
                        <strong class="text-blue-700">图A-C（多种合并策略）:</strong>
                        <ul class="list-disc list-inside mt-1 text-gray-700">
                          <li>Spooky适用于leveling、tiering、lazy leveling</li>
                          <li>在所有策略中均显著改善空间放大</li>
                          <li>写放大保持接近最优水平</li>
                        </ul>
                      </div>
                      <div>
                        <strong class="text-green-700">图D（X参数调优）:</strong>
                        <ul class="list-disc list-inside mt-1 text-gray-700">
                          <li>X=L-1：系统可能因空间不足崩溃</li>
                          <li>X=L-2：最佳实践平衡点</li>
                          <li>X=L-4：文件数过多可能超过系统限制</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </details>
              
              <!-- Partial Merge大文件实验 -->
              <div class="p-4 bg-red-50 rounded-lg border border-red-200">
                <h4 class="font-bold text-red-700 mb-3 flex items-center">
                  <i class="fas fa-exclamation-triangle mr-2"></i>
                  重要发现：Partial Merge大文件无法解决问题
                </h4>
                
                <div class="space-y-4">
                  <p class="text-gray-700">直觉上认为使用大文件可以改善Partial Merge的GC开销，但实验证明无效：</p>
                  
                  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                    <div class="p-3 bg-white rounded border border-red-200">
                      <div class="text-center font-bold text-red-600 mb-1">10GB文件</div>
                      <p class="text-xs text-gray-600 text-center">系统崩溃</p>
                    </div>
                    
                    <div class="p-3 bg-white rounded border border-red-200">
                      <div class="text-center font-bold text-red-600 mb-1">5GB文件</div>
                      <p class="text-xs text-gray-600 text-center">系统崩溃</p>
                    </div>
                    
                    <div class="p-3 bg-white rounded border border-red-200">
                      <div class="text-center font-bold text-red-600 mb-1">2GB文件</div>
                      <p class="text-xs text-gray-600 text-center">GC开销仍严重</p>
                    </div>
                  </div>
                  
                  <div class="mt-4 p-3 bg-white rounded border border-gray-300">
                    <p class="text-sm text-gray-700">
                      <strong>根本原因：</strong>即使使用大文件，并发合并仍会导致文件物理交错，SSD垃圾回收开销仍然很高。这表明Partial Merge的GC问题不是调参问题，而是其设计固有的缺陷。
                    </p>
                  </div>
                </div>
              </div>
              
              <!-- 关键技术洞察 -->
              <div class="p-4 bg-yellow-50 rounded-lg border border-yellow-300">
                <h4 class="font-bold text-yellow-700 mb-3 flex items-center">
                  <i class="fas fa-lightbulb mr-2"></i>
                  关键技术洞察
                </h4>
                
                <div class="space-y-3">
                  <div class="flex items-start">
                    <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                    <div>
                      <strong class="text-green-700">Spooky的核心优势</strong>
                      <p class="text-sm text-gray-700">不是简单的参数调优，而是通过重新设计合并粒度从根本上解决空间放大和写放大的矛盾。</p>
                    </div>
                  </div>
                  
                  <div class="flex items-start">
                    <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                    <div>
                      <strong class="text-green-700">SSD友好设计的重要性</strong>
                      <p class="text-sm text-gray-700">Spooky的顺序I/O模式显著降低了SSD垃圾回收开销，这是传统方法无法实现的。</p>
                    </div>
                  </div>
                  
                  <div class="flex items-start">
                    <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                    <div>
                      <strong class="text-green-700">广泛适用性</strong>
                      <p class="text-sm text-gray-700">Spooky可与多种合并策略结合，为不同应用场景提供优化的性能平衡。</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      
      <!-- 结论 -->
      <section id="conclusion" class="content-section mobile-optimized mb-12 md:mb-16">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 md:mb-8 flex items-center">
          <i class="fas fa-flag-checkered mr-3 text-blue-500"></i>
          结论
        </h2>
        
        <div class="space-y-6">
          <!-- 主要贡献总结 -->
          <div class="bg-white p-6 rounded-lg border border-gray-200 shadow-sm">
            <h3 class="text-xl font-bold text-gray-800 mb-6">
              <i class="fas fa-trophy mr-2 text-yellow-500"></i>
              主要贡献总结
            </h3>
            
            <div class="space-y-6">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="p-4 bg-blue-50 rounded-lg">
                  <h4 class="font-bold text-blue-700 mb-3">理论贡献</h4>
                  <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li><strong>系统分析现有方法缺陷：</strong>通过成本模型和实验揭示了Full Merge和Partial Merge的根本局限性</li>
                    <li><strong>提出新的性能权衡视角：</strong>强调存储利用率与写放大的综合优化</li>
                    <li><strong>建立完整的数学模型：</strong>为LSM-tree合并粒度设计提供理论分析工具</li>
                  </ul>
                </div>
                
                <div class="p-4 bg-green-50 rounded-lg">
                  <h4 class="font-bold text-green-700 mb-3">技术创新</h4>
                  <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li><strong>Spooky设计：</strong>首个同时解决空间放大和写放大问题的合并粒度方法</li>
                    <li><strong>SSD友好I/O模式：</strong>通过顺序写入和删除降低垃圾回收开销</li>
                    <li><strong>广义框架：</strong>可适配多种合并策略和应用场景</li>
                  </ul>
                </div>
              </div>
              
              <div class="p-4 bg-purple-50 rounded-lg">
                <h4 class="font-bold text-purple-700 mb-3">实践价值</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div class="text-center">
                    <div class="text-2xl font-bold text-purple-600 mb-2">＞80%</div>
                    <p class="text-sm font-medium text-purple-700">存储利用率</p>
                    <p class="text-xs text-gray-600">相比Full Merge的50%上限</p>
                  </div>
                  
                  <div class="text-center">
                    <div class="text-2xl font-bold text-green-600 mb-2">＞2.5×</div>
                    <p class="text-sm font-medium text-green-700">写放大改善</p>
                    <p class="text-xs text-gray-600">相比Partial Merge</p>
                  </div>
                  
                  <div class="text-center">
                    <div class="text-2xl font-bold text-blue-600 mb-2">＞2×</div>
                    <p class="text-sm font-medium text-blue-700">空间放大改善</p>
                    <p class="text-xs text-gray-600">相比Full Merge</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 技术局限与未来工作 -->
          <div class="bg-gradient-to-r from-gray-50 to-red-50 p-6 rounded-lg border border-gray-300">
            <h3 class="text-xl font-bold text-gray-800 mb-6">
              <i class="fas fa-exclamation-circle mr-2 text-red-500"></i>
              技术局限与未来工作
            </h3>
            
            <div class="space-y-6">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="p-4 bg-white rounded-lg border border-red-200">
                  <h4 class="font-bold text-red-700 mb-3">当前局限</h4>
                  <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li><strong>文件数量约束：</strong>参数X不能设置过小，否则可能超过系统文件句柄限制</li>
                    <li><strong>倾斜删除处理：</strong>虽然支持但可能需要额外优化</li>
                    <li><strong>内存开销：</strong>更多文件可能增加元数据内存开销</li>
                    <li><strong>实现复杂度：</strong>相比传统方法，Spooky的实现更复杂</li>
                  </ul>
                </div>
                
                <div class="p-4 bg-white rounded-lg border border-blue-200">
                  <h4 class="font-bold text-blue-700 mb-3">未来研究方向</h4>
                  <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li><strong>自适应参数调整：</strong>根据工作负载动态优化X参数</li>
                    <li><strong>新型硬件适配：</strong>与ZNS SSD、计算存储等新技术结合</li>
                    <li><strong>分布式扩展：</strong>在分布式键值存储中应用Spooky</li>
                    <li><strong>机器学习优化：</strong>利用机器学习预测最优合并策略</li>
                  </ul>
                </div>
              </div>
              
              <div class="p-4 bg-yellow-50 rounded-lg border border-yellow-300">
                <h4 class="font-bold text-yellow-700 mb-3 flex items-center">
                  <i class="fas fa-graduation-cap mr-2"></i>
                  对学生的教学意义
                </h4>
                
                <div class="space-y-3">
                  <div class="flex items-start">
                    <i class="fas fa-check text-green-500 mt-1 mr-2"></i>
                    <div>
                      <strong class="text-green-700">系统设计思维：</strong>
                      <p class="text-sm text-gray-700">展示了如何通过系统性分析识别根本问题，并提出创新解决方案。</p>
                    </div>
                  </div>
                  
                  <div class="flex items-start">
                    <i class="fas fa-check text-green-500 mt-1 mr-2"></i>
                    <div>
                      <strong class="text-green-700">权衡分析能力：</strong>
                      <p class="text-sm text-gray-700">强调在系统设计中权衡不同性能指标的重要性。</p>
                    </div>
                  </div>
                  
                  <div class="flex items-start">
                    <i class="fas fa-check text-green-500 mt-1 mr-2"></i>
                    <div>
                      <strong class="text-green-700">实验验证方法：</strong>
                      <p class="text-sm text-gray-700">展示了如何通过严谨的实验设计验证理论分析。</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 最终总结 -->
          <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg border border-green-300">
            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
              <i class="fas fa-flag mr-2 text-green-500"></i>
              最终结论
            </h3>
            
            <div class="space-y-4">
              <p class="text-gray-700 text-lg">
                Spooky代表了LSM-tree合并粒度设计的重要突破，解决了长期存在的空间放大与写放大之间的矛盾。通过创新的分区合并策略和SSD友好设计，Spooky首次实现了在高存储利用率（＞80%）下同时保持适中的写放大。
              </p>
              
              <div class="p-4 bg-white rounded-lg border border-gray-300">
                <p class="text-center text-gray-700 font-medium">
                  <i class="fas fa-quote-left text-blue-400 mr-2"></i>
                  Spooky不仅是现有方法的技术改进，更是对LSM-tree合并粒度设计的根本性重新思考，为未来存储系统设计开辟了新的可能性。
                  <i class="fas fa-quote-right text-blue-400 ml-2"></i>
                </p>
              </div>
              
              <div class="mt-6 text-center">
                <a href="#abstract" class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-medium rounded-lg hover:opacity-90 transition-opacity">
                  <i class="fas fa-redo mr-2"></i>
                  重新浏览摘要
                </a>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
  
  <!-- 交互脚本 -->
  <script>
    // 智能导航和交互功能
    document.addEventListener('DOMContentLoaded', function() {
      const navItems = document.querySelectorAll('.nav-item');
      const sections = document.querySelectorAll('section');
      
      function highlightNav() {
        let current = '';
        sections.forEach(section => {
          const sectionTop = section.offsetTop;
          const sectionHeight = section.clientHeight;
          if (window.scrollY >= (sectionTop - 100)) {
            current = section.getAttribute('id');
          }
        });

        navItems.forEach(item => {
          item.classList.remove('active');
          if (item.getAttribute('href') === `#${current}`) {
            item.classList.add('active');
          }
        });
      }

      window.addEventListener('scroll', highlightNav);
      
      // 平滑滚动
      navItems.forEach(item => {
        item.addEventListener('click', function(e) {
          e.preventDefault();
          const targetId = this.getAttribute('href');
          const targetSection = document.querySelector(targetId);
          window.scrollTo({
            top: targetSection.offsetTop - 80,
            behavior: 'smooth'
          });
        });
      });
      
      // 自动展开第一个技术细节
      const firstDetails = document.querySelector('.technical-details');
      if (firstDetails) {
        firstDetails.open = true;
      }
    });
  </script>
  
  <!-- AI生成内容标识 -->
  <div id="ai-badge" style="position: fixed; bottom: 20px; right: 20px; z-index: 9999; cursor: pointer;">
    <div style="background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; padding: 8px 16px; border-radius: 20px; font-size: 14px; font-weight: 600; box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3); display: flex; align-items: center; gap: 6px; transition: all 0.3s ease;">
      <span style="font-size: 16px;">🤖</span>
      <span>AI生成</span>
    </div>
  </div>
  
  <script>
    (function(){
      const badge = document.getElementById('ai-badge');
      let expanded = false;
      
      badge.addEventListener('click', function(){
        if(!expanded){
          const details = document.createElement('div');
          details.id = 'ai-details';
          details.style.cssText = "position:absolute;bottom:50px;right:0;background:white;color:#333;padding:12px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.15);width:200px;font-size:12px;line-height:1.5;border:1px solid #e5e7eb;";
          details.innerHTML = '<div style="font-weight:600;margin-bottom:8px;color:#6366f1">人工智能生成内容</div><div style="color:#666">本页面内容通过AI技术自动生成，仅供参考。生成时间：' + new Date().toLocaleDateString('zh-CN') + '</div>';
          badge.appendChild(details);
          expanded = true;
        } else {
          const details = document.getElementById('ai-details');
          if(details) details.remove();
          expanded = false;
        }
      });
    })();
  </script>
</body>
</html>